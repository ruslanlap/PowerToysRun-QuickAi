<div align="center">

# ğŸ¤– QuickAI for PowerToys Run

<img src="assets/logo.png" alt="QuickAI Icon" width="128" height="128">

### âš¡ AI-Powered Assistance Right at Your Fingertips âš¡

**Never leave your workflow to get AI help again.**  
Access multiple AI providers instantly with `Alt+Space` â†’ `ai explain quantum computing` â†’ Done! âœ¨

<!-- Badges -->
<a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/actions/workflows/build-and-release-optimized.yml"><img src="https://github.com/ruslanlap/PowerToysRun-QuickAi/actions/workflows/build-and-release-optimized.yml/badge.svg" alt="Build Status"></a>
<a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/releases/latest">
  <img src="https://img.shields.io/github/v/release/ruslanlap/PowerToysRun-QuickAi?label=latest" alt="Latest Release">
</a>
<img src="https://img.shields.io/maintenance/yes/2025" alt="Maintenance">
<img src="https://img.shields.io/badge/C%23-.NET%209.0-512BD4" alt="C# .NET 9.0">
<img src="https://img.shields.io/badge/version-v1.2.0-brightgreen" alt="Version">
<img src="https://img.shields.io/badge/PRs-welcome-brightgreen.svg" alt="PRs Welcome">
<a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/stargazers">
  <img src="https://img.shields.io/github/stars/ruslanlap/PowerToysRun-QuickAi" alt="GitHub stars">
</a>
<a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/issues">
  <img src="https://img.shields.io/github/issues/ruslanlap/PowerToysRun-QuickAi" alt="GitHub issues">
</a>
<a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/releases/latest">
  <img src="https://img.shields.io/github/downloads/ruslanlap/PowerToysRun-QuickAi/total" alt="GitHub all releases">
</a>
<img src="https://img.shields.io/badge/Made%20with-â¤ï¸-red" alt="Made with Love">
<img src="https://img.shields.io/badge/AI%20Powered-Yes-orange" alt="AI Powered">
<img src="https://img.shields.io/badge/PowerToys-Compatible-blue" alt="PowerToys Compatible">
<img src="https://img.shields.io/badge/platform-Windows-lightgrey" alt="Platform">
<a href="https://opensource.org/licenses/MIT">
  <img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License">
</a>
<a href="https://github.com/hlaueriksson/awesome-powertoys-run-plugins">
  <img src="https://awesome.re/mentioned-badge.svg" alt="Mentioned in Awesome PowerToys Run Plugins">
</a>

</div>

<div align="center">
  <a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/releases/download/v1.2.0/QuickAi-1.2.0-x64.zip">
    <img src="https://img.shields.io/badge/â¬‡ï¸_DOWNLOAD-x64-blue?style=for-the-badge&logo=github" alt="Download x64">
  </a>
  <a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/releases/download/v1.2.0/QuickAi-1.2.0-ARM64.zip">
    <img src="https://img.shields.io/badge/â¬‡ï¸_DOWNLOAD-ARM64-blue?style=for-the-badge&logo=github" alt="Download ARM64">
  </a>
</div>

## ğŸ“Š Download Statistics

<div align="center">
  <img src="https://img.shields.io/github/downloads/ruslanlap/PowerToysRun-QuickAi/total?color=orange&style=for-the-badge&label=Total%20Downloads" height="60" alt="Total Downloads">
</div>

---

## ğŸ¯ Why Developers Love QuickAI

<div align="center">

**"Stop switching between browser tabs and AI chat interfaces"**

| âŒ Before | âœ… With QuickAI |
|-----------|-----------------|
| Open browser â†’ Login to AI â†’ Type question â†’ Copy | `Alt+Space` â†’ `ai speed of light` â†’ Copy |
| 30+ seconds, context switching | **2 seconds, zero interruption** |

</div>

### ğŸš€ **Quick Demo** - Try it now:
```
Alt+Space â†’ ai explain recursion    # ğŸ§  Complex concepts
Alt+Space â†’ ai write python script  # ğŸ Code generation  
Alt+Space â†’ ai summarize this       # ğŸ“ Text analysis
Alt+Space â†’ ai translate to french  # ğŸŒ Language tasks
```

<div align="center">
  <img src="assets/demo-ai.gif" alt="QuickAI Plugin Demo" width="600">
  
  **â¬‡ï¸ Ready to boost your productivity?**
  
  <a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/releases/download/v1.2.0/QuickAi-1.2.0-x64.zip">
    <img src="https://img.shields.io/badge/Download_for-x64_Windows-0078d4?style=for-the-badge&logo=windows&logoColor=white" alt="Download x64">
  </a>
  <a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/releases/download/v1.2.0/QuickAi-1.2.0-ARM64.zip">
    <img src="https://img.shields.io/badge/Download_for-ARM64_Windows-0078d4?style=for-the-badge&logo=windows&logoColor=white" alt="Download ARM64">
  </a>
</div>

## ğŸ§­ Table of Contents

- [Overview](#-overview)
- [Recent Changelog](#-recent-changelog)
- [Features](#-features)
- [Supported AI Providers](#-supported-ai-providers)
- [Demo](#-demo)
- [Quick Start](#-quick-start)
- [Installation](#-installation)
- [Configuration](#-configuration)
- [Usage Examples](#-usage-examples)
- [Advanced Features](#-advanced-features)
- [Building from Source](#-building-from-source)
- [Development & Quality](#-development--quality)
- [Project Structure](#-project-structure)
- [FAQ](#-faq)
- [Troubleshooting](#-troubleshooting)
- [Security & Privacy](#-security--privacy)
- [Tech Stack](#-tech-stack)
- [Contributing](#-contributing)
- [Screenshots](#-screenshots)
- [Support the Project](#-support-the-project)
- [License](#-license)
- [Acknowledgements](#-acknowledgements)

## ğŸ“ Overview

**QuickAI** brings the power of multiple AI providers directly into PowerToys Run. Get instant, streaming responses from leading AI models without leaving your workflow. Launch PowerToys Run with `Alt+Space`, type `ai` (or your custom keyword), and ask anything.

- **Plugin ID:** `420129A62ECA49848C5C7CA229BFD22C`
- **Action Keyword:** `ai` or change to `quickai`
- **Platform:** Windows 10/11 (x64, ARM64)
- **Tech:** C#/.NET 9.0, WPF, PowerToys Run API

---

## ğŸ“‹ Recent Changelog

### ğŸ’¬ v1.2.0 - Custom System Prompt & Clipboard Image Attachment

<div align="center">

#### ğŸ¯ Custom System Prompt
Configure persistent instructions that are sent before every query across all AI providers!

<!-- Screenshot placeholder: System Prompt Settings -->
<img src="assets/v1.2.0-system-prompt.png" alt="System Prompt Setting" width="700">
<br><em>Configure custom system instructions like "You are a concise assistant" for consistent AI behavior</em>

#### ğŸ“¸ Clipboard Image Attachment 
Attach screenshots and images directly to your queries for vision/multimodal AI models!

<!-- Screenshot placeholder: Screenshot Reading Example -->
<img src="assets/v1.2.0-screenshot-reading.png" alt="Screenshot Reading Example" width="700">
<br><em>QuickAI reading text from a clipboard screenshot - perfect for code analysis, error messages, and visual content</em>

#### ğŸ¨ Enhanced UI Indicators
Visual feedback when image attachment is enabled with ğŸ“ indicator in the query subtitle.

<!-- Screenshot placeholder: UI with Image Indicator -->
<img src="assets/v1.2.0-ui-indicator.png" alt="Image Attachment UI Indicator" width="700">
<br><em>Clear visual feedback when clipboard image attachment is active</em>

</div>

**New Features:**
- ğŸ’¬ **Custom System Prompt**: Persistent instructions sent before every query (works across all providers)
  - OpenAI: `role: system` message format
  - Google: `systemInstruction` field  
  - Cohere: `preamble` field
- ğŸ“¸ **Clipboard Image Attachment**: Send clipboard images with queries for vision models
  - OpenAI-compatible: `image_url` format
  - Google: `inlineData` format
  - UI shows ğŸ“ indicator when active
- ğŸ¯ **Provider-Aware Payloads**: Restructured request building for cleaner system prompt and image injection
- ğŸ“‹ **Enhanced Settings**: New configuration options in PowerToys settings panel

**Perfect for:**
- ğŸ“ **Code Analysis**: Screenshot code and ask "explain this error"
- ğŸ“Š **Data Interpretation**: Screenshot charts/graphs and ask for analysis  
- ğŸ–¼ï¸ **Visual Content**: Process images, diagrams, and visual information
- ğŸ­ **Consistent AI Behavior**: Set custom personality or response style

**Thanks to [@ELGUAPOLIFE](https://github.com/ELGUAPOLIFE) for the feature request ([#13](https://github.com/ruslanlap/PowerToysRun-QuickAi/issues/13))!**

---

### ğŸ¨ v1.1.1 - UI Overhaul & Enhanced Experience

<div align="center">
<img src="assets/v1.1.1.png" alt="QuickAI v1.1.1 - New Results Window" width="800">
</div>

**Major UI Improvements:**
- ğŸªŸ **New Dedicated Results Window**: Replaced static MessageBox with a beautiful, full-featured WPF window
- ğŸ“ **Markdown Rendering**: Proper support for **bold**, *italic*, `code blocks`, and inline code
- ğŸ¨ **Modern Typography**: Inter font for UI and JetBrains Mono for code (matching Cursor editor style)
- ğŸŒ“ **Dynamic Theme Support**: Automatic light/dark mode with real-time theme updates when system theme changes
- ğŸ”„ **Real-time Streaming**: Token-by-token updates directly in the results window
- ğŸ“‹ **Enhanced UX**: Copy button, word wrap toggle, character counter, and keyboard shortcuts (Ctrl+C, Esc)
- ğŸ§¹ **Clean Interface**: Query box automatically clears when opening results window
- ğŸ“œ **Auto-scroll**: Automatically scrolls to bottom as new content streams in

**Thanks to [@WuJunkai2004](https://github.com/WuJunkai2004) (Wu Junkai) for the ideas and contributions!**

---

### ğŸ‰ v1.1.0 - Local AI with Ollama

**Major Feature:**
- ğŸ  **Local AI Support**: Run AI models completely offline on your own machine with **zero API costs**
- ğŸ”’ **Full Privacy**: All processing happens locally - no data leaves your computer
- ğŸ’° **Zero Cost**: Unlimited queries with no API fees
- ğŸš€ **Fast**: No network latency, instant responses
- ğŸ”§ **Flexible**: Use any Ollama model - llama3.2, mistral, qwen2.5, deepseek-r1, etc.
- âš™ï¸ **Customizable**: Configure custom host URL for remote Ollama instances

**Thanks to [@fuzhiyin-7](https://github.com/fuzhiyin-7) for suggesting this feature!**

---

## âš¡ Features That Matter

<div align="center">
<table>
<tr>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Rocket/3D/rocket_3d.png">
<br><b>âš¡ Streaming Responses</b><br>
<sub>Real-time token-by-token<br>display as you type</sub>
</td>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Globe%20showing%20americas/3D/globe_showing_americas_3d.png">
<br><b>ğŸŒ Multi-Provider</b><br>
<sub>Groq, Together, Fireworks,<br>OpenRouter, Cohere, Google, Ollama</sub>
</td>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Key/3D/key_3d.png">
<br><b>ğŸ”‘ Dual API Keys</b><br>
<sub>Primary key with automatic<br>secondary key fallback</sub>
</td>
</tr>
<tr>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Gear/3D/gear_3d.png">
<br><b>âš™ï¸ Highly Configurable</b><br>
<sub>Customize model, temperature,<br>max tokens, and timeout</sub>
</td>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Clipboard/3D/clipboard_3d.png">
<br><b>ğŸ“‹ One-Click Copy</b><br>
<sub>Press Enter to copy<br>responses to clipboard</sub>
</td>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Thinking%20Face/3D/thinking_face_3d.png">
<br><b>ğŸ’¬ Custom System Prompt</b><br>
<sub>Persistent instructions<br>before every query</sub>
</td>
</tr>
<tr>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Camera/3D/camera_3d.png">
<br><b>ğŸ“¸ Clipboard Images</b><br>
<sub>Attach screenshots for<br>vision AI models</sub>
</td>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/Display/3D/display_3d.png">
<br><b>ğŸªŸ Results Window</b><br>
<sub>Dedicated window with<br>markdown rendering</sub>
</td>
<td align="center" width="33%">
<img width="60" src="https://raw.githubusercontent.com/microsoft/fluentui-emoji/main/assets/House/3D/house_3d.png">
<br><b>ğŸ  Local AI</b><br>
<sub>Run models offline<br>with Ollama</sub>
</td>
</tr>
</table>
</div>

---

## ğŸ¤– Supported AI Providers

| Provider | Endpoint | Default Model | API Schema |
|----------|----------|---------------|------------|
| **Groq** | `https://api.groq.com/openai/v1/chat/completions` | `llama-3.1-8b-instant` | OpenAI |
| **Together** | `https://api.together.xyz/v1/chat/completions` | `llama-3.1-8b-instant` | OpenAI |
| **Fireworks** | `https://api.fireworks.ai/inference/v1/chat/completions` | `llama-3.1-8b-instant` | OpenAI |
| **OpenRouter** | `https://openrouter.ai/api/v1/chat/completions` | `llama-3.1-8b-instant` | OpenAI |
| **Cohere** | `https://api.cohere.com/v1/chat` | `command` | Cohere |
| **Google** | `https://generativelanguage.googleapis.com/v1beta` | `gemini-1.5-flash` | Google |
| **Ollama** ğŸ†• | `http://localhost:11434/v1/chat/completions` | `llama3.2` | OpenAI |

> ğŸ‰ **New in v1.1.0**: Local AI with Ollama support! Run models on your own machine with zero API costs. Thanks to [@fuzhiyin-7](https://github.com/fuzhiyin-7) for the idea!
> 
> ğŸ¨ **New in v1.1.1**: Dedicated Results Window with markdown rendering, modern typography (Inter & JetBrains Mono), dynamic theme support, and enhanced UX! Thanks to [@WuJunkai2004](https://github.com/WuJunkai2004) for the ideas!
> 
> ğŸ’¬ **New in v1.2.0**: Custom System Prompt & Clipboard Image Attachment! Configure persistent instructions and attach screenshots for vision models. Thanks to [@ELGUAPOLIFE](https://github.com/ELGUAPOLIFE) for the feature request!

---

## ğŸ“¸ Demo Gallery

<div align="center">

### AI Assistant in Action
<img src="assets/demo.png" alt="QuickAI Interface" width="700">

### Streaming Response
<img src="assets/demo2.png" alt="Streaming Response" width="700">

### Plugin Settings
<img src="assets/demo3.png" alt="Settings Panel" width="700">

### Multiple Use Cases
<img src="assets/demo5.png" alt="Various Use Cases" width="700">

### New Results Window (v1.1.1)
<img src="assets/v1.1.1.png" alt="New Results Window with Markdown Support" width="800">

### Custom System Prompt (v1.2.0)
<img src="assets/v1.2.0-system-prompt.png" alt="System Prompt Configuration" width="800">

### Clipboard Image Attachment (v1.2.0)
<img src="assets/v1.2.0-screenshot-reading.png" alt="Screenshot Reading Example" width="800">

### Image Attachment UI Indicator (v1.2.0)
<img src="assets/v1.2.0-ui-indicator.png" alt="Image Attachment UI Indicator" width="800">

</div>

---

## ğŸƒâ€â™‚ï¸ Get Started in 60 Seconds

### 1ï¸âƒ£ **Download & Extract** (15 seconds)
```bash
# Choose your architecture
wget https://github.com/ruslanlap/PowerToysRun-QuickAi/releases/download/v1.2.0/QuickAi-1.2.0-x64.zip
# Extract to PowerToys plugin directory
```

### 2ï¸âƒ£ **Auto-Install Location** (30 seconds)
```
%LOCALAPPDATA%\Microsoft\PowerToys\PowerToys Run\Plugins\QuickAi
```

### 3ï¸âƒ£ **Restart PowerToys** (15 seconds)
Right-click PowerToys tray icon â†’ Exit â†’ Restart from Start Menu

### 4ï¸âƒ£ **Configure API Key** ğŸ¯
1. Open PowerToys Settings â†’ PowerToys Run â†’ Plugins â†’ QuickAI
2. Enter your API key for the preferred provider
3. Hit `Alt+Space` â†’ Type `ai what is quantum computing?` â†’ Marvel at the magic! âœ¨

> **Pro Tip:** Change the keyword from `ai` to `q` or `ask` in PowerToys settings for even faster access!

---

## ğŸ’¡ Power User Commands

<div align="left">

```bash
# ğŸ§  Complex Explanations
ai explain machine learning in simple terms
ai how does blockchain work?
ai what is the difference between REST and GraphQL?

# ğŸ’» Code Generation & Help
ai write a python function to sort a list
ai debug this javascript code: [paste code]
ai convert this sql to mongodb query

# ğŸ“ Text Processing
ai summarize this text: [paste text]
ai improve the grammar of this sentence
ai translate "hello world" to spanish

# ğŸ¯ Creative Tasks
ai write a poem about programming
ai brainstorm ideas for a mobile app
ai create a product description for headphones

# ğŸ“¸ Vision & Screenshot Tasks (NEW!)
ai what does this error message mean? ğŸ“ (with clipboard screenshot)
ai explain this code snippet ğŸ“ (with clipboard screenshot)
ai read the text from this image ğŸ“ (with clipboard screenshot)
ai analyze this chart/graph ğŸ“ (with clipboard screenshot)

# ğŸ’¬ System Prompt Examples
# Set system prompt to "You are a concise assistant" then:
ai explain quantum computing
# Set system prompt to "You are a helpful coding tutor" then:
ai debug this python code
```

</div>

<details>
<summary><b>ğŸ¨ See All Available Features</b></summary>

- **Streaming Responses**: Watch answers appear in real-time (updates every 3 tokens or 150ms)
- **Context Menu**: Right-click results for:
  - Show full response (Enter)
  - Copy response (Ctrl+C)
  - Restart query (Ctrl+R)
- **Multi-language Support**: Works with any language
- **Code Highlighting**: Syntax-aware responses for code snippets
- **History**: Previous responses cached for quick reference
- **Custom Models**: Use any model from supported providers

</details>

## ğŸ”§ Advanced Configuration

<details>
<summary><b>ğŸ¯ Customize Your Experience</b></summary>

### Change Trigger Keyword
**PowerToys Settings** â†’ **PowerToys Run** â†’ **Plugins** â†’ **QuickAI** â†’ Change `ai` to your preference

### Optimize Performance  
- **Temperature**: Adjust creativity (0.0 = factual, 2.0 = creative, default: 0.2)
- **Max Tokens**: Control response length (16-4096, default: 128)
- **Request Timeout**: Configure timeout in seconds (3-30, default: 8)
- **Model Selection**: Choose specific models per provider
- **Dual API Keys**: Configure backup keys for reliability

### ğŸ†• New Advanced Features
- **System Prompt**: Configure persistent instructions sent before every query (e.g., "You are a concise assistant")
  - Works across all providers with native API support
  - Perfect for setting consistent AI personality or response style
- **Clipboard Image Attachment**: Toggle to attach clipboard images with queries
  - Requires vision-capable models (GPT-4V, Gemini Pro Vision, etc.)
  - Shows ğŸ“ indicator when enabled
  - Great for code analysis, error messages, charts, and visual content

### Provider-Specific Settings
- **Groq**: Best for speed with Llama models
- **Together**: Wide variety of open-source models
- **Fireworks**: Fast inference with custom models
- **OpenRouter**: Access to multiple providers via one key
- **Cohere**: Enterprise-grade models with different API
- **Google**: Google Gemini models (API key passed as URL parameter)
- **Ollama** ğŸ†•: Run models locally on your machine - zero API costs, complete privacy, customizable host URL

### âš ï¸ **Important: Model Name Configuration**

**Critical**: Always copy the **exact model name** from your provider's documentation or dashboard. Model names vary by provider and must match exactly:

**Examples of correct model names:**
- **Groq**: `llama-3.1-8b-instant`, `mixtral-8x7b-32768`
- **Together**: `meta-llama/Llama-3-8b-chat-hf`, `mistralai/Mixtral-8x7B-Instruct-v0.1`
- **Fireworks**: `accounts/fireworks/models/llama-v3p1-8b-instruct` âš ï¸ (must include full path)
- **OpenRouter**: `meta-llama/llama-3.1-8b-instruct`, `anthropic/claude-3-haiku`
- **Cohere**: `command`, `command-light`, `command-nightly`
- **Google**: `gemini-1.5-flash`, `gemini-1.5-pro`, `gemini-pro`
- **Ollama** ğŸ†•: `llama3.2`, `mistral`, `qwen2.5`, `codellama`, `deepseek-r1` (any locally pulled model)

<div align="center">
<img src="assets/settings.png" alt="Settings Example" width="600">
<br><sub>Example: Fireworks requires full model path like <code>accounts/fireworks/models/llama-v3p1-8b-instruct</code></sub>
</div>

**Where to find correct model names:**
- **Groq**: [console.groq.com/docs/models](https://console.groq.com/docs/models)
- **Together**: [docs.together.ai/docs/inference-models](https://docs.together.ai/docs/inference-models)
- **Fireworks**: [docs.fireworks.ai/models](https://docs.fireworks.ai/models) - Copy from "Model ID" field
- **OpenRouter**: [openrouter.ai/models](https://openrouter.ai/models)
- **Cohere**: [docs.cohere.com/docs/models](https://docs.cohere.com/docs/models)
- **Google**: [ai.google.dev/models](https://ai.google.dev/models) - Google Gemini models
- **Ollama** ğŸ†•: [ollama.com/library](https://ollama.com/library) - Run `ollama list` to see locally pulled models

</details>

---

## ğŸ”‘ API Key Acquisition

<details>
<summary><b>How to Get Your API Keys</b></summary>

### Groq
1. Visit [https://console.groq.com](https://console.groq.com)
2. Sign up or log in
3. Navigate to API Keys section
4. Create a new API key
5. Copy and paste into QuickAI settings

### Together
1. Visit [https://api.together.xyz](https://api.together.xyz)
2. Create an account
3. Go to Settings â†’ API Keys
4. Generate a new key
5. Copy and paste into QuickAI settings

### Fireworks
1. Visit [https://fireworks.ai](https://fireworks.ai)
2. Sign up for an account
3. Navigate to API Keys
4. Create a new key
5. Copy and paste into QuickAI settings

### OpenRouter
1. Visit [https://openrouter.ai](https://openrouter.ai)
2. Sign up or log in
3. Go to Keys section
4. Generate an API key
5. Copy and paste into QuickAI settings

### Cohere
1. Visit [https://cohere.com](https://cohere.com)
2. Create an account
3. Navigate to API Keys
4. Create a new key
5. Copy and paste into QuickAI settings

### Google
1. Visit [https://ai.google.dev](https://ai.google.dev)
2. Sign up or log in with your Google account
3. Navigate to Get API Key section
4. Create a new API key
5. Copy and paste into QuickAI settings

### Ollama (Local - No API Key Required!) ğŸ†•
1. Install Ollama from [https://ollama.com](https://ollama.com)
2. Run `ollama serve` to start the local server
3. Pull a model: `ollama pull llama3.2` (or any model)
4. Select "Ollama" provider in QuickAI settings
5. Set model name to your pulled model (e.g., `llama3.2`, `mistral`, `qwen2.5`)
6. Optionally configure custom host URL (default: `http://localhost:11434`)

**ğŸ’¡ Tip**: Most cloud providers offer free tiers perfect for testing QuickAI! With Ollama, run unlimited queries locally for free!

</details>

---

## ğŸ”§ Technical Details

<details>
<summary><b>Architecture & Implementation</b></summary>

### Architecture
- **Target Framework**: .NET 9.0 Windows (10.0.22621.0)
- **Plugin Type**: PowerToys Run Plugin (DynamicLoading: false)
- **HTTP Client**: Static singleton with configurable timeout (default: 8 seconds, range: 3-30)
- **Streaming**: Server-Sent Events (SSE) parsing with real-time UI updates
- **JSON**: System.Text.Json for serialization
- **UI**: WPF with theme-aware design

### Implementation Highlights
- Implements `IPlugin` for PowerToys Run integration
- Implements `ISettingProvider` for GUI configuration via `AdditionalOptions`
- Implements `IContextMenu` for right-click actions (show full response, copy, restart)
- Implements `IDisposable` for proper resource cleanup
- Async HTTP requests with `Task.Run()` for non-blocking queries
- Real-time result updates during streaming (batched every 3 tokens or 150ms for performance)
- Automatic retry with secondary API key on failure
- Thread-safe response building with `StringBuilder`
- Supports multiple API schemas (OpenAI, Cohere, Google Gemini)

### Error Handling
- Validates API key presence before requests
- Handles network failures gracefully
- Shows user-friendly error messages
- Configurable timeout protection (default: 8 seconds, range: 3-30)
- JSON parsing error recovery
- Automatic fallback to secondary API key

### Project Structure
```
PowerToysRun-QuickAi/
â”œâ”€â”€ QuickAi/
â”‚   â”œâ”€â”€ Community.PowerToys.Run.Plugin.QuickAi/
â”‚   â”‚   â”œâ”€â”€ Main.cs                    # Core plugin implementation (1275 lines)
â”‚   â”‚   â”œâ”€â”€ plugin.json                # Plugin manifest
â”‚   â”‚   â”œâ”€â”€ *.csproj                   # Project file
â”‚   â”‚   â””â”€â”€ Images/
â”‚   â”‚       â”œâ”€â”€ ai.dark.png           # Dark theme icon
â”‚   â”‚       â””â”€â”€ ai.light.png          # Light theme icon
â”‚   â””â”€â”€ QuickAi.sln                   # Solution file
â”œâ”€â”€ assets/                            # README images and demos
â”œâ”€â”€ .github/workflows/                 # CI/CD automation
â””â”€â”€ README.md                          # This file
```

</details>

---

## ğŸ—ï¸ For Developers

### ğŸš€ **Quick Build**
```bash
git clone https://github.com/ruslanlap/PowerToysRun-QuickAi.git
cd PowerToysRun-QuickAi
./build-and-zip.sh  # Creates distribution-ready packages
```

### ğŸ§ª **Tech Stack**
- **Runtime**: .NET 9.0 with Windows 10/11 target  
- **UI**: WPF with theme-aware design
- **HTTP**: HttpClient with streaming support
- **Architecture**: Service-oriented with clean separation
- **Serialization**: System.Text.Json for API responses

### ğŸ¯ **Project Highlights**  
- **Clean Code**: Well-documented, testable architecture
- **Multi-Platform**: x64 + ARM64 builds
- **Streaming**: Real-time response handling
- **Plugin Template**: Great starting point for other PowerToys plugins
- **Provider Abstraction**: Easy to add new AI providers

<div align="left">

**Want to contribute?** 

[![Contribute](https://img.shields.io/badge/PRs-Welcome-brightgreen?style=for-the-badge&logo=github)](CONTRIBUTING.md) 
[![Issues](https://img.shields.io/github/issues/ruslanlap/PowerToysRun-QuickAi?style=for-the-badge&logo=github&color=red)](https://github.com/ruslanlap/PowerToysRun-QuickAi/issues)

</div>

---

## ğŸŒŸ Community & Support

<div align="left">

### Show Some Love â¤ï¸

If QuickAI boosts your productivity, consider starring the repo and sharing with colleagues!

[![Star this repo](https://img.shields.io/badge/â­_Star_on_GitHub-ffcc00?style=for-the-badge&logo=github&logoColor=black)](https://github.com/ruslanlap/PowerToysRun-QuickAi/stargazers)
[![Tweet about it](https://img.shields.io/badge/Tweet-1DA1F2?style=for-the-badge&logo=twitter&logoColor=white)](https://twitter.com/intent/tweet?text=Just%20found%20this%20amazing%20PowerToys%20Run%20plugin%20for%20AI%20assistance!%20ğŸ¤–&url=https://github.com/ruslanlap/PowerToysRun-QuickAi)

### Support Development â˜•

[![Buy me a coffee](https://img.shields.io/badge/Buy_me_a_coffee-FFDD00?style=for-the-badge&logo=buy-me-a-coffee&logoColor=black)](https://ruslanlap.github.io/ruslanlap_buymeacoffe/)

### Join the Community

- ğŸ› [Report bugs](https://github.com/ruslanlap/PowerToysRun-QuickAi/issues)
- ğŸ’¡ [Request features](https://github.com/ruslanlap/PowerToysRun-QuickAi/issues)  
- ğŸ¤ [Contribute](CONTRIBUTING.md)
- ğŸ“¢ [Awesome PowerToys Plugins](https://github.com/hlaueriksson/awesome-powertoys-run-plugins)

</div>

---

## ğŸ†˜ Troubleshooting

<details>
<summary><b>Plugin not showing up?</b></summary>

- âœ… **Check path**: `%LOCALAPPDATA%\Microsoft\PowerToys\PowerToys Run\Plugins\QuickAi`  
- âœ… **Verify files**: Ensure `plugin.json` exists in the folder
- âœ… **Restart**: Completely exit and restart PowerToys
- âœ… **Permissions**: Run PowerToys as administrator once

</details>

<details>
<summary><b>API requests failing?</b></summary>

- âœ… **API Key**: Verify your API key is correct and active
- âœ… **Internet**: Check connection for API requests
- âœ… **Provider**: Ensure selected provider is available
- âœ… **Model**: Verify model name is supported by provider

</details>

<details>
<summary><b>Streaming not working?</b></summary>

- âœ… **Network**: Check if streaming is blocked by firewall
- âœ… **Timeout**: Increase timeout in plugin settings
- âœ… **Provider**: Some providers may have streaming limitations

</details>

<details>
<summary><b>"Show full response" only shows partial text?</b></summary>

From [issue #3](https://github.com/ruslanlap/PowerToysRun-QuickAi/issues/3#issuecomment-3681606400): this is **expected** when the AI response is truncated by settings, not a UI bug. The provider stops early if token limits or timeouts are too low, so the modal only shows the first words.

**What to do**
- âœ… **Increase Max Tokens**: Try 2048â€“4096 to allow full answers.
- âœ… **Raise Request Timeout**: Low timeouts can cut responses.
- âœ… **Provider limits**: Some providers enforce their own caps.
- â„¹ï¸ **Temperature**: Only affects creativity, not length.

If you still need the full text, press `Ctrl+C` in the result list to copy the complete response.

</details>

---

## â“ FAQ

<details>
<summary><b>How do I change the AI provider?</b></summary>
PowerToys Settings â†’ PowerToys Run â†’ Plugins â†’ QuickAI â†’ Select provider from dropdown
</details>

<details>
<summary><b>Can I use multiple API keys?</b></summary>
Yes! Configure both primary and secondary API keys. The plugin will automatically fallback if the primary fails.
</details>

<details>
<summary><b>What models are supported?</b></summary>
Any model supported by your chosen provider. Popular choices include Llama 3.1, Mixtral, and provider-specific models.
</details>

<details>
<summary><b>Is my data private?</b></summary>
Your queries are sent to the chosen AI provider's API. Check each provider's privacy policy for details on data handling. **NEW**: With Ollama, everything stays on your machine - complete privacy!
</details>

<details>
<summary><b>Can I use it offline?</b></summary>
Cloud providers (Groq, Together, etc.) require internet. **NEW**: With Ollama, you can run AI completely offline on your local machine!
</details>

<details>
<summary><b>How do I use Ollama for local AI?</b></summary>
1. Install Ollama from [ollama.com](https://ollama.com)<br>
2. Run `ollama serve` in terminal<br>
3. Pull a model: `ollama pull llama3.2`<br>
4. Select "Ollama" in QuickAI settings<br>
5. Set model name to your pulled model<br>
6. Enjoy unlimited local AI queries with zero API costs!
</details>

---

## ğŸ”’ Privacy & Security

- âœ… **Local Plugin**: All plugin functionality runs locally
- âœ… **No Tracking**: Zero analytics or telemetry from the plugin
- âœ… **Open Source**: Full code transparency
- âœ… **MIT License**: Free for any use

### âš ï¸ API Key Storage

**Important Security Notice**: API keys are currently stored in **plain text** in PowerToys settings JSON file:
```
%LOCALAPPDATA%\Microsoft\PowerToys\PowerToys Run\settings.json
```

**Security Recommendations**:
- âœ… Use API keys with **limited permissions** or quotas
- âœ… Do **not** use production or billing-critical keys
- âœ… Consider **rotating keys periodically**
- âœ… Avoid sharing your settings.json file
- âœ… Use provider-specific key restrictions (IP allowlists, rate limits)

**Future Enhancement**: Windows DPAPI encryption for API keys is planned for a future release.

### Data Privacy
- Your queries are sent to the **chosen AI provider's API**
- QuickAI plugin itself does **not collect or store** any query data
- Check each provider's privacy policy for their data handling practices
- Most providers use queries for model improvement (check provider settings to opt-out)
- ğŸ†• **Ollama**: Complete privacy - all processing happens locally on your machine, no data leaves your computer

---

## ğŸ“„ License

Released under the [MIT License](LICENSE). Free for personal and commercial use.

---

## ğŸ™ Acknowledgements

**Powered by amazing AI providers:**
- [Groq](https://groq.com/) - Fast inference platform
- [Together AI](https://www.together.ai/) - Open-source model platform
- [Fireworks AI](https://fireworks.ai/) - AI model inference
- [OpenRouter](https://openrouter.ai/) - Unified AI API access
- [Cohere](https://cohere.com/) - Enterprise AI models
- [Google AI](https://ai.google.dev/) - Google Gemini models
- [Ollama](https://ollama.com/) - Local AI model runner

**Built with:**
- [Microsoft PowerToys](https://github.com/microsoft/PowerToys) - The extensible Windows productivity toolkit
- [.NET](https://dotnet.microsoft.com/) - Cross-platform development platform

**Special Thanks:**
- [@fuzhiyin-7](https://github.com/fuzhiyin-7) - For suggesting Ollama integration, bringing local AI support to QuickAI! ğŸ‰
- [@WuJunkai2004](https://github.com/WuJunkai2004) (Wu Junkai) - For ideas and contributions that inspired the major UI overhaul with dedicated ResultsWindow, markdown rendering, and improved user experience in v1.1.1! ğŸ¨âœ¨
- [@ELGUAPOLIFE](https://github.com/ELGUAPOLIFE) - For the feature request that brought custom system prompts and clipboard image attachment to QuickAI in v1.2.0! ğŸ’¬ğŸ“¸

---

<div align="center">

### ğŸš€ **Ready to supercharge your workflow with AI?**

<a href="https://github.com/ruslanlap/PowerToysRun-QuickAi/releases/latest">
<img src="https://img.shields.io/badge/Download_Now-Success-brightgreen?style=for-the-badge&logo=download&logoColor=white" alt="Download Now">
</a>

<sub>Made with â¤ï¸ by <a href="https://github.com/ruslanlap">@ruslanlap</a></sub>

</div>














